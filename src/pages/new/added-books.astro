---
import Layout from "@/layouts/Layout.astro";
const listBook = [
  {
    id: 1,
    src: "/rekomendasi-1.png",
    title: "1 Jam Ahli Pemrograman : HTML, CSS, Dan Javascript",
    author: "Adam Saputra",
  },
  {
    id: 2,
    src: "/rekomendasi-2.png",
    title: "The Intelligent Investor",
    author: "+++",
  },
  {
    id: 3,
    src: "/rekomendasi-3.png",
    title: "Atomic Habits",
    author: "James Clear",
  },
  {
    id: 4,
    src: "/rekomendasi-4.png",
    title: "Outliers",
    author: "Malcolm Gladwell",
  },
  {
    id: 5,
    src: "/rekomendasi-5.png",
    title: "Mark Manson: Everything Is F*Cked",
    author: "Mark Manson",
  },
  {
    id: 6,
    src: "/rekomendasi-6.png",
    title: "Atomic Habits",
    author: "James Clear",
  },
];

const popularList = [
  {
    id: 1,
    title: "Outliers",
    author: "Malcolm Gladwell",
  },
  {
    id: 2,
    title: "Everything Is F*cked",
    author: "Mark Manson",
  },
  {
    id: 3,
    title: "12 Rules For Life: An Antidote To Chaos",
    author: "Jordan B. Peterson",
  },
  {
    id: 4,
    title: "Desain Grafis dengan Canva untuk Pemula",
    author: "Jubilee Enterprise",
  },
];
---

<script>
  //-----------------------------------------------------------------------------//
  const modal_chooseBook = document.querySelector("#modal_choose-book");
  const modal_chooseBook_overlay = document.querySelector(
    "#modal_choose-book #overlay"
  );

  modal_chooseBook_overlay.addEventListener("click", () => {
    if (modal_chooseBook?.classList?.contains("flex")) {
      modal_chooseBook?.classList?.remove("flex");
      modal_chooseBook?.classList?.add("hidden");
    }
  });
  //-----------------------------------------------------------------------------//
  const close_modal = document.querySelector("#close-modal");

  close_modal?.addEventListener("click", () => {
    if (modal_chooseBook?.classList?.contains("flex")) {
      modal_chooseBook?.classList?.remove("flex");
      modal_chooseBook?.classList?.add("hidden");
    }
  });
  //-----------------------------------------------------------------------------//
  const book_recommendation = document.querySelector("#book-recommendation");

  book_recommendation?.addEventListener("click", () => {
    if (modal_chooseBook?.classList?.contains("hidden")) {
      modal_chooseBook?.classList?.remove("hidden");
      modal_chooseBook?.classList?.add("flex");
    }
  });
  //-----------------------------------------------------------------------------//
  const valueList = document.querySelector("#valueList");
  let valueListText = `<span> Buku dipilih</span>`;

  let listArray = [];

  const checkboxes = document.querySelectorAll(".checkbox");
  const next_btn: HTMLElement = document.querySelector("#next-btn");

  checkboxes?.forEach((checkbox) => {
    checkbox?.addEventListener("click", () => {
      if (checkbox?.checked) {
        listArray?.push(checkbox?.value);
        valueList.innerHTML = listArray?.length + valueListText;
      } else {
        listArray = listArray?.filter((e) => e !== checkbox?.value);
        valueList.innerHTML = listArray?.length + valueListText;
      }

      if (listArray?.length > 3) {
        next_btn?.classList?.remove("bg-[#72D1A6]");
        next_btn?.classList?.add("bg-[#128C55]");
      } else {
        next_btn?.classList?.remove("bg-[#128C55]");
        next_btn?.classList?.add("bg-[#72D1A6]");
      }
    });
  });

  //-----------------------------------------------------------------------------//
  next_btn?.addEventListener("click", () => {
    if (
      modal_chooseBook?.classList?.contains("flex") &&
      next_btn?.classList?.contains("bg-[#128C55]")
    ) {
      modal_chooseBook?.classList?.remove("flex");
      modal_chooseBook?.classList?.add("hidden");
    }

    window.setTimeout(() => {
      window.location.href = "/new/recommendation";
    }, 1500);
  });
  //-----------------------------------------------------------------------------//
  const modal_signup = document.querySelector("#modal-signup");

  window.setTimeout(() => {
    if (modal_signup?.classList?.contains("hidden")) {
      modal_signup?.classList?.remove("hidden");
      modal_signup?.classList?.add("flex");
    }
  }, 1500);
  //-----------------------------------------------------------------------------//
  const modal_signup_overlay = document.querySelector("#modal-signup #overlay");

  modal_signup_overlay?.addEventListener("click", () => {
    if (modal_signup?.classList?.contains("flex")) {
      modal_signup?.classList?.remove("flex");
      modal_signup?.classList?.add("hidden");
    }
  });
  //-----------------------------------------------------------------------------//
  const close_modal_signup = document.querySelector("#close-modal-signup");

  close_modal_signup?.addEventListener("click", () => {
    if (modal_signup?.classList?.contains("flex")) {
      modal_signup?.classList?.remove("flex");
      modal_signup?.classList?.add("hidden");
    }
  });
  //-----------------------------------------------------------------------------//
</script>

<Layout title="Recommendation Book" loggedIn>
  <!-- Modal Signup -->
  <div
    id="modal-signup"
    class="fixed inset-0 z-[99999999] hidden h-full w-full items-center justify-center"
  >
    <div id="overlay" class="absolute inset-0 z-0 h-full w-full bg-black/50">
    </div>

    <div
      class="relative z-10 -mt-0 min-h-screen w-full max-w-4xl px-0 lg:-mt-12 lg:min-h-max lg:px-8"
    >
      <nav
        class="flex items-center justify-between border-b border-[#EBEBEB] bg-white/95 p-4 pt-4 lg:justify-center lg:rounded-t-2xl lg:border-b-0 lg:pt-11"
      >
        <h1
          class="text-left font-arvo text-xl font-normal lg:text-center lg:text-4xl"
        >
          Rekomendasi Buku Untukmu
        </h1>

        <button id="close-modal-signup" class="block lg:hidden">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M19.6649 18.0492C20.1117 18.496 20.1117 19.2183 19.6649 19.6651C19.442 19.888 19.1495 20 18.8569 20C18.5643 20 18.2718 19.888 18.0489 19.6651L12 13.6161L5.95107 19.6651C5.72822 19.888 5.43566 20 5.1431 20C4.85054 20 4.55798 19.888 4.33513 19.6651C3.88829 19.2183 3.88829 18.496 4.33513 18.0492L10.3841 12.0001L4.33513 5.95111C3.88829 5.50426 3.88829 4.78199 4.33513 4.33514C4.78197 3.88829 5.50423 3.88829 5.95107 4.33514L12 10.3842L18.0489 4.33514C18.4958 3.88829 19.218 3.88829 19.6649 4.33514C20.1117 4.78199 20.1117 5.50426 19.6649 5.95111L13.6159 12.0001L19.6649 18.0492Z"
              fill="#2E2E2E"></path>
          </svg>
        </button>
      </nav>

      <h3 class="bg-white/95 py-4 text-center text-sm leading-5 lg:py-0">
        Kami telah memilih rekomendasi yang cocok buat kamu
      </h3>

      <div
        class="relative z-10 h-[calc(100vh_-_113px)] bg-white/95 px-6 pt-11 lg:h-auto lg:rounded-b-2xl lg:pb-14 lg:pt-11"
      >
        <img
          class="absolute left-1/2 top-1/2 h-auto w-full -translate-x-1/2 -translate-y-1/2"
          src="/books-blur.png"
          alt="Books Blur"
        />
        <div class="relative z-10 flex h-full flex-col items-center">
          <h5 class="mb-6 text-center text-base font-bold">
            Daftar sekarang untuk melihat rekomendasi.
          </h5>

          <div class="flex w-full max-w-sm flex-col items-start gap-4">
            <button
              class="relative flex w-full items-center justify-center gap-3 rounded-full border-2 border-black bg-white py-4"
            >
              <img class="h-6 w-6" src="/icon-google.png" alt="Icon Google" />

              <p class="text-base font-semibold leading-5">
                Sign up with Google
              </p>
            </button>

            <button
              class="relative flex w-full items-center justify-center gap-3 rounded-full border-2 border-black bg-white py-4"
            >
              <img
                class="h-6 w-6"
                src="/icon-facebook.png"
                alt="Icon facebook"
              />

              <p class="text-base font-semibold leading-5">
                Sign up with Facebook
              </p>
            </button>

            <button
              class="relative flex w-full items-center justify-center gap-3 rounded-full border-2 border-black bg-white py-4"
            >
              <img class="h-6 w-6" src="/icon-x.png" alt="Icon x" />

              <p class="text-base font-semibold leading-5">Sign up with X</p>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Pilih Buku -->
  <div
    id="modal_choose-book"
    class="fixed inset-0 z-[999999999] hidden h-full w-full items-center justify-center"
  >
    <!-- overlay -->
    <div id="overlay" class="fixed inset-0 z-10 h-full w-full bg-black/50">
    </div>

    <!-- content -->
    <div
      class="relative z-20 h-screen w-full max-w-4xl overflow-hidden bg-white p-0 lg:h-full lg:max-h-[576px] lg:rounded-2xl lg:p-11"
    >
      <!-- if 404 use mb-6 otherwise mb-14 -->
      <header class="mb-2 flex flex-col items-center lg:mb-6">
        <nav
          class="mb-2 flex w-full items-center justify-between border-b border-[#EBEBEB] p-4 lg:justify-center lg:border-b-0 lg:p-0"
        >
          <h1
            class="w-auto text-left font-arvo text-xl leading-none text-[#2e2e2e] lg:w-full lg:text-center lg:text-[34px]"
          >
            Pilih Buku
          </h1>

          <button id="close-modal" class="block lg:hidden">
            <svg
              class="h-6 w-6"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M19.6646 18.0489C20.1115 18.4958 20.1115 19.2181 19.6646 19.6649C19.4418 19.8878 19.1492 19.9998 18.8567 19.9998C18.5641 19.9998 18.2715 19.8878 18.0487 19.6649L11.9998 13.6159L5.95083 19.6649C5.72798 19.8878 5.43542 19.9998 5.14286 19.9998C4.8503 19.9998 4.55774 19.8878 4.33489 19.6649C3.88805 19.2181 3.88805 18.4958 4.33489 18.0489L10.3838 11.9999L4.33489 5.95086C3.88805 5.50401 3.88805 4.78174 4.33489 4.33489C4.78173 3.88804 5.50399 3.88804 5.95083 4.33489L11.9998 10.3839L18.0487 4.33489C18.4955 3.88804 19.2178 3.88804 19.6646 4.33489C20.1115 4.78174 20.1115 5.50401 19.6646 5.95086L13.6157 11.9999L19.6646 18.0489Z"
                fill="#2E2E2E"></path>
            </svg>
          </button>
        </nav>

        <p class="mb-5 text-base font-normal leading-6 text-[#636363]">
          Kami menampilkan sesuai kategori yang kamu pilih.
        </p>

        <!-- search -->
        <div class="flex w-full items-center justify-center gap-4 px-4 lg:px-0">
          <div class="relative w-full lg:max-w-sm">
            <svg
              class="absolute left-4 top-1/2 z-10 h-6 w-6 -translate-y-1/2 lg:left-6"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M5 10C5 6.691 7.691 4 11 4C14.309 4 17 6.691 17 10C17 13.309 14.309 16 11 16C7.691 16 5 13.309 5 10ZM21.707 19.293L17.312 14.897C18.366 13.542 19 11.846 19 10C19 5.589 15.411 2 11 2C6.589 2 3 5.589 3 10C3 14.411 6.589 18 11 18C12.846 18 14.542 17.366 15.897 16.312L20.293 20.707C20.488 20.902 20.744 21 21 21C21.256 21 21.512 20.902 21.707 20.707C22.098 20.316 22.098 19.684 21.707 19.293Z"
                fill="#8D8D8D"></path>
            </svg>

            <input
              type="text"
              class="w-full rounded-full border border-[#dedede] py-2 pl-12 lg:pl-16"
              placeholder="Cari judul buku sesuai kategori..."
            />
          </div>

          <button class="block flex-shrink-0 text-sm lg:hidden">Cari</button>
        </div>
      </header>

      <!-- search found / initial list -->
      <section
        class="block h-[calc(100vh_-_288px)] overflow-y-auto p-4 lg:h-auto lg:p-0"
      >
        <div
          class="grid w-full grid-cols-3 place-items-center justify-center gap-4 lg:grid-cols-7 lg:gap-6"
        >
          {
            [1, 2, 3, 4, 5, 6, 7].map((item) => {
              return (
                <div>
                  <input
                    type="checkbox"
                    id={`checkbox item-${item}`}
                    value={`item-${item}`}
                    class="checkbox peer hidden"
                  />

                  <label
                    for={`checkbox item-${item}`}
                    class="w-full cursor-pointer font-normal peer-checked:font-semibold [&>img]:shadow-sm peer-checked:[&>img]:shadow-2xl"
                  >
                    <figure class="relative space-y-3">
                      <img
                        class="h-auto w-full"
                        src="/choose-book-1.png"
                        alt="Choose Book 1"
                      />

                      <h5 class="pointer-events-none text-sm leading-5">
                        The Subtle Art of Not Giving A
                      </h5>
                    </figure>
                  </label>
                </div>
              );
            })
          }
        </div>
      </section>

      <div
        class="absolute bottom-0 left-0 z-10 flex h-28 w-full flex-col items-start gap-2 border-t bg-[#FCFAF7] p-4 shadow-xl lg:flex-row lg:items-center lg:justify-between lg:border-0 lg:px-14 lg:py-8 lg:shadow-none"
      >
        <div class="print-values">
          <h5
            id="valueList"
            class="text-base font-bold leading-5 text-[#141414]"
          >
            0 Buku dipilih
          </h5>
        </div>

        <div class="flex w-full flex-row gap-2 lg:w-auto lg:gap-4">
          <button
            class="w-full rounded-full border border-[#222222] bg-white px-6 py-3 text-base font-bold leading-5 text-[#222222] lg:w-auto lg:py-4"
          >
            Sebelumnya
          </button>

          <button
            id="next-btn"
            class="w-full cursor-pointer rounded-full bg-[#72D1A6] px-6 py-3 text-base font-bold leading-5 text-white disabled:cursor-auto lg:w-auto lg:py-4"
          >
            Selanjutnya
          </button>
        </div>
      </div>
    </div>
  </div>

  <div
    class="container relative mx-auto grid h-full min-h-screen max-w-screen-xl grid-cols-1 px-4 lg:grid-cols-12 lg:gap-10 xl:px-12"
  >
    <section class="col-span-1 mt-20 lg:col-span-9 lg:mt-28">
      <h1 class="mb-4 font-arvo text-2xl leading-7 lg:text-3xl">Rekomendasi</h1>

      <div class="flex flex-col items-center gap-6">
        <img
          class="h-auto w-56"
          src="/rekomendasi-404.png"
          alt="Recommendation 404"
        />

        <h5 class="text-base font-semibold">
          Anda belum mendapatkan rekomendasi buku.
        </h5>

        <button
          id="book-recommendation"
          type="button"
          class="flex items-center justify-center rounded-full bg-[#128C55] px-6 py-4 font-bold text-white transition-all duration-300 ease-out hover:bg-[#128C55]/90 lg:w-60"
        >
          Coba Rekomendasi Buku
        </button>
      </div>

      <div class="my-8 hidden h-px w-full bg-[#dcdcdc] lg:block"></div>

      <header class="mb-6 hidden items-center gap-3 lg:flex">
        <h1 class="font-arvo text-2xl leading-7 lg:text-3xl">Giveaway</h1>

        <button
          class="-mb-1.5 rounded-[4px] bg-[#D6E4FE] px-3 py-1 text-xs font-semibold"
        >
          Beta
        </button>
      </header>

      <div
        class="mb-20 hidden grid-cols-2 gap-4 lg:grid lg:grid-cols-4 lg:gap-6"
      >
        {
          listBook.map((item) => {
            return (
              <figure class="space-y-2.5 lg:space-y-5">
                <img
                  src={item.src ?? `/rekomendasi-1.png`}
                  alt="Rekomendasi 1"
                />

                <figcaption class="space-y-2">
                  <a href="/" class="hover:underline">
                    <h5 class="line-clamp-2 text-base font-semibold leading-[1.25] lg:text-lg lg:leading-[1.125]">
                      {item.title ??
                        "1 Jam Ahli Pemrograman : HTML, CSS, Dan Javascript"}
                    </h5>
                  </a>

                  <a href="/" class="text-sm text-[#515151] hover:underline">
                    by {item.author ?? "Adam Saputra"}
                  </a>
                </figcaption>
              </figure>
            );
          })
        }
      </div>
    </section>

    <div class="relative col-span-1 lg:sticky lg:top-32 lg:col-span-3 lg:mt-32">
      <div class="my-8 block h-px w-full bg-[#dcdcdc] lg:hidden"></div>

      <section class="relative mb-8">
        <header class="mb-2 space-y-4">
          <h3 class="font-arvo text-2xl leading-7 lg:text-3xl">Want to Read</h3>

          <p class="text-sm font-semibold">
            Tambahkan bacaan yang ingin anda baca dari rekomendasi buku.
          </p>
        </header>

        <p class="text-sm text-[#515151]">
          In her second novel, The Stationery Shop, Marjan Kamali weaves a
          heartbreaking tale
        </p>
      </section>

      <div class="my-8 block h-px w-full bg-[#dcdcdc] lg:hidden"></div>

      <section class="relative mb-8">
        <h3 class="mb-4 font-arvo text-2xl leading-7 lg:text-3xl">
          Popular This Week
        </h3>

        <div class="mb-4 space-y-4">
          {
            popularList.map((item) => {
              return (
                <figure class="group relative space-y-2">
                  <a class="absolute inset-0 z-10 h-full w-full" href="/" />
                  <h5 class="text-sm font-semibold group-hover:underline">
                    {item.title ?? "Outliers"}
                  </h5>

                  <p class="text-sm text-[#515151]">
                    by {item.author ?? "Malcolm Gladwells"}
                  </p>
                </figure>
              );
            })
          }
        </div>

        <button
          id="search-book"
          type="button"
          class="relative flex items-center justify-center rounded-full bg-[#128C55] px-8 py-2 font-bold text-white transition-all duration-300 ease-out hover:bg-[#128C55]/90"
        >
          Cari Buku
        </button>
      </section>
    </div>
  </div>
</Layout>
